+++
title = "PostgreSQL的備份與復原"
date = "2016-05-30"
+++

安迪兒最較常用到PostgreSQL備資料倒資料  
記錄一下操作的方式  

1、備份data  
PostgreSQL內建使用**pg_dump**

```
pg_dump [資料庫名] -U [帳號] -f [備份檔案.sql]

另一種備份整個db的  
 pg_dump -h x.x.x.x -p 5432 -U admin -F c -b -v -f "xx.dbf" xxdatabase
```

```
pg_dump meta_development -U posxxx -f postgres-db-20160530.sql  
```

<img src="https://goo.gl/LEwRb1" width="70%">

2、還原
PostgreSQL內建使用**psql**


```
psql -f [備份檔案名稱] [資料庫] [帳號]  

還原整個db的   
pg_restore -h x.x.x.x -p 5432 -U admin -d xxdatabase -v "xx.dbf"  
```

```
psql -f xx.sql test posxxx
```

<img src="https://goo.gl/CL69Hh" width="100%">


看一下是不是有把資料回灌到test database了  
嗯~~資料已經進去原來的test嘍    

<img src="https://goo.gl/ExCJDm" width="100%">

其它:設定不輸入密碼  
1.  /etc/profile.local 加上  
```  
export PGPASSWORD="密碼"  
```  

2. 使用者的家目錄($HOME)下，新增一個.pgpass檔   
```
hostname:port:database:username:password   
```  

差別是第2種可以指定特定的database不輸入密碼  

以上~~收工嘍!
